---
title: 用Excel或WPS做两独立样本的T检验
author: 欧阳松
date: '2021-10-12'
slug: [excel-ttest]
categories: [excel]
tags: [ttest]
editor_options: 
  markdown: 
    wrap: 72
---

首先需要清楚做`两独立样本的比较`时的统计思维是：

-   先做`方差齐性检验`，看样本量是否呈正态分布

1.  如果方差`不具有齐性` 或`非正态分布`
    (P\<0.05）的时候应该做`F检验`（`非参数检验`）
2.  如果方差`具有齐性`（P\>0.05）的时候才做`t检验`

一般情况下收集数据时常用的是`Excel`或者`WPS`，但统计时却用`SPSS`等软件进行统计学分析，经常很多人找不到`SPSS`的安装包，或者苦于正版激活或忘记教程，其实`Excel`或`WPS`自带函数就足够了，`均数`、`标准差`以及`统计检验`都是一个函数而已。
现实例演示如下：
首先准备一个表格，包含分组和数值（分组可以单独合并为一列，也可以分开分列），如下所示：

| 分组 | 数值     |
|------|----------|
| A    | 0.71807  |
| A    | 0.95688  |
| A    | 1.59678  |
| A    | 1.64213  |
| A    | 1.65913  |
| B    | -0.19068 |
| B    | -0.06133 |
| B    | -0.0075  |
| B    | 0.034571 |
| B    | 0.33896  |
| B    | 0.28263  |
| B    | 0.41011  |
| B    | 0.43011  |
| B    | 1.32853  |
| B    | 1.54944  |
| B    | 1.63888  |
| B    | 0.27518  |
| B    | 0.69552  |

另起一列，输入以下函数，记得`=`不能少，符号为`半角`

-   A组的**均数**计算 `=AVERAGE(B2:B6)`
-   A组的**标准差**计算 `=STDEV(B2:B6)`
-   B的**均数**计算`=AVERAGE(B7:B19)`
-   B组的**标准差**计算`=STDEV(B7:B19)`
-   **t检验P值**的计算  
    `=IF(FTEST(B2:B6,B7:B19)>0.05,TTEST(B2:B6,B7:B19,2,2),TTEST(B2:B6,B7:B19,2,3))`

---

解释：先做F检验，如果F\>0.05就做T检验，Ttset里的数据为两组的数据的比较，结果如下

|分组  | 数值     | A组均数    | A组标准差  | p值        |
|------|----------|------------|------------|------------|
| A    | 0.71807  | 1.314598   | 0.44424487 | 0.01820667 |
| A    | 0.95688  | B组均数    | B组标准差  |            |
| A    | 1.59678  | 0.51726315 | 0.61388048 |            |
| A    | 1.64213  |            |            |            |
| A    | 1.65913  |            |            |            |
| B    | -0.19068 |            |            |            |
| B    | -0.06133 |            |            |            |
| B    | -0.0075  |            |            |            |
| B    | 0.034571 |            |            |            |
| B    | 0.33896  |            |            |            |
| B    | 0.28263  |            |            |            |
| B    | 0.41011  |            |            |            |
| B    | 0.43011  |            |            |            |
| B    | 1.32853  |            |            |            |
| B    | 1.54944  |            |            |            |
| B    | 1.63888  |            |            |            |
| B    | 0.27518  |            |            |            |
| B    | 0.69552  |            |            |            |
